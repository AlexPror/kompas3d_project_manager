# üîß Hotfix v2.2.1 - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ö–û–ú–ü–ê–°-3D

## üêõ –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:
```
–û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞: (-2147220995, '–û–±—ä–µ–∫—Ç –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ —Å–µ—Ä–≤–µ—Ä—É', None, None)
```

**–ü—Ä–∏—á–∏–Ω–∞**: COM-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ö–û–ú–ü–ê–°-3D —Ä–∞–∑—Ä—ã–≤–∞–ª–æ—Å—å –º–µ–∂–¥—É –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏.

---

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. **–£–ª—É—á—à–µ–Ω –º–µ—Ç–æ–¥ `connect_to_kompas()`**

–î–æ–±–∞–≤–ª–µ–Ω—ã:
- –ü–∞—Ä–∞–º–µ—Ç—Ä `force_reconnect` –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∂–∏–≤–æ—Å—Ç–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–≤—è–∑–∏
- –ü–æ–ø—ã—Ç–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —ç–∫–∑–µ–º–ø–ª—è—Ä –ö–û–ú–ü–ê–° –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π

### 2. **–û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç:
```python
self.connect_to_kompas(force_reconnect=True)
```

**–û–±–Ω–æ–≤–ª–µ–Ω—ã**:
- `CascadingVariablesUpdater` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- `DesignationUpdaterFixed` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–π
- `DrawingAutoUpdater` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä—Ç–µ–∂–µ–π  
- `UnfoldingDxfExporter` - —ç–∫—Å–ø–æ—Ä—Ç DXF
- `DrawingExporter` - —ç–∫—Å–ø–æ—Ä—Ç –≤ BMP

### 3. **–î–æ–±–∞–≤–ª–µ–Ω–æ –∑–∞–∫—Ä—ã—Ç–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**

–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç:
1. –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
2. –î–µ–ª–∞–µ—Ç –ø–∞—É–∑—É –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏
3. –¢–æ–ª—å–∫–æ –ø–æ—Ç–æ–º –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞–±–æ—Ç—É

---

## üöÄ –ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É

1. **–ó–∞–∫—Ä–æ–π—Ç–µ** —Ç–µ–∫—É—â–µ–µ –æ–∫–Ω–æ –ø—Ä–æ–≥—Ä–∞–º–º—ã
2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ** –∑–∞–Ω–æ–≤–æ: `run.bat` –∏–ª–∏ `python gui_kompas_manager.py`
3. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ** —Å–Ω–æ–≤–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ï—Å–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è

1. –û—Ç–∫—Ä–æ–π—Ç–µ **–î–∏—Å–ø–µ—Ç—á–µ—Ä –∑–∞–¥–∞—á** (Ctrl+Shift+Esc)
2. –ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å **Python** 
3. –ó–∞–≤–µ—Ä—à–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É –∑–∞–Ω–æ–≤–æ

---

## üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç 1: –°–æ–∑–¥–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

1. –ò—Å—Ö–æ–¥–Ω—ã–π –ø—Ä–æ–µ–∫—Ç: `ZVD.LITE.110.180.1330`
2. –ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç: `ZVD.LITE.110.180.2140`
3. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: H=110, B1=180, L1=2140
4. –ù–∞–∂–∞—Ç—å: "üöÄ –ü–û–õ–ù–´–ô –¶–ò–ö–õ"
5. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –í—Å–µ 9 —à–∞–≥–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ ‚úÖ

### –¢–µ—Å—Ç 2: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø–æ–¥—Ä—è–¥

1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç 1: `ZVD.LITE.110.180.2140`
2. **–ù–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º—É**, —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç 2: `ZVD.LITE.110.180.2500`
3. **–ù–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º—É**, —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç 3: `ZVD.LITE.110.180.3000`
4. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã —Å–æ–∑–¥–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ –±–µ–∑ –æ—à–∏–±–æ–∫ ‚úÖ

---

## üîç –ß—Ç–æ —É–ª—É—á—à–∏–ª–æ—Å—å

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚ùå –û—à–∏–±–∫–∞ "–û–±—ä–µ–∫—Ç –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ —Å–µ—Ä–≤–µ—Ä—É"
- ‚ùå –¢—Ä–µ–±–æ–≤–∞–ª—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã
- ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø–æ–¥—Ä—è–¥

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ö–û–ú–ü–ê–°-3D
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–≤—è–∑–∏
- ‚úÖ –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç—ã –æ–¥–∏–Ω –∑–∞ –¥—Ä—É–≥–∏–º
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã

---

## üìä –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ú–µ—Ç–æ–¥ `connect_to_kompas()` (base_component.py)

```python
def connect_to_kompas(self, force_reconnect: bool = False) -> bool:
    # –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏–ª–∏ –µ—â–µ –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–ª–∏—Å—å
    if force_reconnect or not self.connected:
        pythoncom.CoInitialize()
        
        # –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å —É–∂–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä
        try:
            self.application = Dispatch("Kompas.Application.7")
        except:
            # –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å, —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π
            self.application = DispatchEx("Kompas.Application.7")
        
        self.application.Visible = True
        self.connected = True
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∂–∏–≤–æ–µ
    if self.connected:
        try:
            _ = self.application.Visible
            return True
        except:
            # –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—è–Ω–æ, –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è
            self.connected = False
            return self.connect_to_kompas(force_reconnect=True)
    
    return True
```

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

```python
# 1. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
if not self.connect_to_kompas(force_reconnect=True):
    return error
    
# 2. –ó–∞–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
self.close_all_documents()
time.sleep(0.5)

# 3. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π
# ... —Ä–∞–±–æ—Ç–∞ —Å –ö–û–ú–ü–ê–°-3D ...
```

---

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–ö–û–ú–ü–ê–°-3D –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω** –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
2. **–ù–µ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ** –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
3. **–ù–µ —Ä–∞–±–æ—Ç–∞–π—Ç–µ** –≤—Ä—É—á–Ω—É—é –≤ –ö–û–ú–ü–ê–°-3D –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π

---

## üìù Changelog

### v2.2.1 (28.10.2025)

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø–æ—Ç–µ—Ä—è COM-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ö–û–ú–ü–ê–°-3D
- –î–æ–±–∞–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∂–∏–≤–æ—Å—Ç–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –£–ª—É—á—à–µ–Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø–æ–¥—Ä—è–¥

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- `components/base_component.py`
- `components/cascading_variables_updater.py`
- `components/drawing_auto_updater.py`
- `components/designation_updater_fixed.py`
- `components/unfolding_dxf_exporter.py`
- `components/drawing_exporter.py`

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!

**–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø–æ–¥—Ä—è–¥.**

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è, —Å–æ–æ–±—â–∏—Ç–µ:
1. –¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ –∏–∑ –ª–æ–≥–æ–≤
2. –ù–∞ –∫–∞–∫–æ–º —à–∞–≥–µ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞
3. –°–∫–æ–ª—å–∫–æ –ø—Ä–æ–µ–∫—Ç–æ–≤ —É—Å–ø–µ–ª–∏ —Å–æ–∑–¥–∞—Ç—å –¥–æ –æ—à–∏–±–∫–∏

---

**–î–∞—Ç–∞**: 28.10.2025  
**–í–µ—Ä—Å–∏—è**: 2.2.1 (Hotfix)  
**–°—Ç–∞—Ç—É—Å**: –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é üöÄ

